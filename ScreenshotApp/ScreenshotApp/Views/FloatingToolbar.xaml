<UserControl x:Class="ScreenshotApp.Views.FloatingToolbar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="60" d:DesignWidth="280"
             x:Name="FloatingToolbarControl"
             Loaded="OnFloatingToolbarLoaded"
             Unloaded="OnFloatingToolbarUnloaded"
             RenderTransformOrigin="0.5,0.5">

    <UserControl.Resources>
        <!-- Tool Button Style: 44x44px circular with keyboard focus support -->
        <Style x:Key="ToolButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="44"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Focusable" Value="True"/>
            <Setter Property="IsTabStop" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="ButtonBorder"
                               Background="{TemplateBinding Background}"
                               BorderBrush="Transparent"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="22"
                               Width="44"
                               Height="44">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Content="{TemplateBinding Content}"
                                            ContentTemplate="{TemplateBinding ContentTemplate}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="#268ecae6"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="#4D8ECAE6"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.3"/>
                            </Trigger>
                            <!-- Active state (Pen by default) -->
                            <Trigger Property="IsDefault" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="#66219ebc"/>
                            </Trigger>
                            <!-- Focus state (keyboard navigation) - 2px ocean mist outline -->
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="ButtonBorder" Property="BorderBrush" Value="#8ecae6"/>
                                <Setter TargetName="ButtonBorder" Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Toolbar Divider Style -->
        <Style x:Key="ToolbarDividerStyle" TargetType="Separator">
            <Setter Property="Width" Value="1"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="Background" Value="#8ECAE6"/>
            <Setter Property="Opacity" Value="0.5"/>
        </Style>

        <!-- Color Swatch Style: 28px circular with selected indicator -->
        <Style x:Key="ColorSwatchStyle" TargetType="Button">
            <Setter Property="Width" Value="28"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Focusable" Value="True"/>
            <Setter Property="IsTabStop" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="SwatchBorder"
                               Background="{Binding Background, RelativeSource={RelativeSource TemplatedParent}}"
                               BorderBrush="White"
                               BorderThickness="0"
                               CornerRadius="14"
                               Width="28"
                               Height="28">
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="0"
                                                 BlurRadius="2"
                                                 Color="Black"
                                                 Opacity="0.3"/>
                            </Border.Effect>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Selected state: 2px dark border for visibility on all colors -->
                            <Trigger Property="IsDefault" Value="True">
                                <Setter TargetName="SwatchBorder" Property="BorderBrush" Value="#333333"/>
                                <Setter TargetName="SwatchBorder" Property="BorderThickness" Value="2"/>
                            </Trigger>
                            <!-- Hover state: ocean mist border -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="SwatchBorder" Property="BorderBrush" Value="#8ecae6"/>
                                <Setter TargetName="SwatchBorder" Property="BorderThickness" Value="2"/>
                            </Trigger>
                            <!-- Focus state: ocean mist border -->
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="SwatchBorder" Property="BorderBrush" Value="#8ecae6"/>
                                <Setter TargetName="SwatchBorder" Property="BorderThickness" Value="2"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="SwatchBorder" Property="BorderThickness" Value="3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <!-- Main Toolbar Container -->
    <Border x:Name="ToolbarBorder"
           Background="#023047"
           Opacity="0.95"
           CornerRadius="16"
           Padding="8,6"
           SnapsToDevicePixels="True"
           UseLayoutRounding="True"
           RenderTransformOrigin="0.5,0.5">
        <Border.Effect>
            <DropShadowEffect ShadowDepth="0"
                             BlurRadius="16"
                             Color="Black"
                             Opacity="0.4"/>
        </Border.Effect>

        <Border.RenderTransform>
            <TransformGroup>
                <ScaleTransform x:Name="ToolbarScale" ScaleX="0" ScaleY="0"/>
                <TranslateTransform x:Name="ToolbarTranslate" X="0" Y="20"/>
            </TransformGroup>
        </Border.RenderTransform>

        <StackPanel Orientation="Horizontal"
                     VerticalAlignment="Center"
                     HorizontalAlignment="Center">

            <!-- Pen Tool (Active by default) -->
            <Button x:Name="PenToolButton"
                   Style="{StaticResource ToolButtonStyle}"
                   Content="✎"
                   ToolTip="Pen tool (P)"
                   IsDefault="True"
                   Click="OnPenToolClick"/>

            <!-- Rectangle Tool (Placeholder - disabled) -->
            <Button Style="{StaticResource ToolButtonStyle}"
                   Content="□"
                   ToolTip="Rectangle tool (R) - Coming soon"
                   IsEnabled="False"/>

            <!-- Circle Tool (Placeholder - disabled) -->
            <Button Style="{StaticResource ToolButtonStyle}"
                   Content="○"
                   ToolTip="Circle tool (C) - Coming soon"
                   IsEnabled="False"/>

            <!-- Arrow Tool (Placeholder - disabled) -->
            <Button Style="{StaticResource ToolButtonStyle}"
                   Content="→"
                   ToolTip="Arrow tool (A) - Coming soon"
                   IsEnabled="False"/>

            <!-- Text Tool (Placeholder - disabled) -->
            <Button Style="{StaticResource ToolButtonStyle}"
                   Content="T"
                   ToolTip="Text tool (T) - Coming soon"
                   IsEnabled="False"/>

            <!-- Divider between tools and colors -->
            <Separator Style="{StaticResource ToolbarDividerStyle}"/>

            <!-- Color Palette: 6 colors (Black, Red, Blue, Green, Yellow, White) -->
            <StackPanel x:Name="ColorPalettePanel"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="4,0,0,0">
                <!-- Black (default selected) -->
                <Button x:Name="BlackColorButton"
                       Style="{StaticResource ColorSwatchStyle}"
                       Background="#000000"
                       ToolTip="Black"
                       IsDefault="True"
                       Click="OnColorClick"
                       Tag="#000000"/>

                <!-- Red -->
                <Button Style="{StaticResource ColorSwatchStyle}"
                       Background="#FF0000"
                       ToolTip="Red"
                       Margin="4,0,0,0"
                       Click="OnColorClick"
                       Tag="#FF0000"/>

                <!-- Blue -->
                <Button Style="{StaticResource ColorSwatchStyle}"
                       Background="#0000FF"
                       ToolTip="Blue"
                       Margin="4,0,0,0"
                       Click="OnColorClick"
                       Tag="#0000FF"/>

                <!-- Green -->
                <Button Style="{StaticResource ColorSwatchStyle}"
                       Background="#008000"
                       ToolTip="Green"
                       Margin="4,0,0,0"
                       Click="OnColorClick"
                       Tag="#008000"/>

                <!-- Yellow -->
                <Button Style="{StaticResource ColorSwatchStyle}"
                       Background="#FFFF00"
                       ToolTip="Yellow"
                       Margin="4,0,0,0"
                       Click="OnColorClick"
                       Tag="#FFFF00"/>

                <!-- White -->
                <Button Style="{StaticResource ColorSwatchStyle}"
                       Background="#FFFFFF"
                       ToolTip="White"
                       Margin="4,0,0,0"
                       Click="OnColorClick"
                       Tag="#FFFFFF"/>
            </StackPanel>

            <!-- Divider -->
            <Separator Style="{StaticResource ToolbarDividerStyle}"/>

            <!-- Close Button -->
            <Button Style="{StaticResource ToolButtonStyle}"
                   Content="✕"
                   ToolTip="Close (Esc)"
                   Click="OnCloseClick"/>

        </StackPanel>
    </Border>
</UserControl>
